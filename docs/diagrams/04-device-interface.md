# ESP32 Device Interface & OLED Display States

## OLED Display Screen States

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                           ESP32 OLED DISPLAY (128x64 pixels - 0.93" SPI)                            │
│                                    Display States & Transitions                                      │
└─────────────────────────────────────────────────────────────────────────────────────────────────────┘


╔═════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                   STATE 1: BOOT/IDLE SCREEN                                         ║
╠═════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                     ║
║    ┌────────────────────────────────────────────────────┐                                          ║
║    │ [Attendro]                                         │                                          ║
║    │ Device: D001                                       │                                          ║
║    │ IP: 192.168.1.45                                  │                                          ║
║    │ Status: ○ IDLE                                     │                                          ║
║    │ WiFi: ▓▓▓▓ Connected                               │                                          ║
║    │ Waiting for lecture...                            │                                          ║
║    │                                                    │                                          ║
║    │ [Battery: 100%]                                   │                                          ║
║    └────────────────────────────────────────────────────┘                                          ║
║                                                                                                     ║
║    Updates Every: 2 seconds                                                                         ║
║    Transition: When session starts                                                                 ║
║                                                                                                     ║
╚═════════════════════════════════════════════════════════════════════════════════════════════════════╝


╔═════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                               STATE 2: SESSION ACTIVE SCREEN                                        ║
╠═════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                     ║
║    ┌────────────────────────────────────────────────────┐                                          ║
║    │ [Active Session]                                   │                                          ║
║    │ Subject: Data Structures                          │                                          ║
║    │ Class: SEM-4-A                                    │                                          ║
║    │ Batch: A                                          │                                          ║
║    │ Time Left: 45 min 30 sec                          │                                          ║
║    │ Scanned: 28/60                                    │                                          ║
║    │ ► Scan your finger ◄                             │                                          ║
║    │                                                    │                                          ║
║    │ [WiFi: ▓▓▓▓] [Battery: 85%]                        │                                          ║
║    └────────────────────────────────────────────────────┘                                          ║
║                                                                                                     ║
║    Updates Every: 1 second                                                                         ║
║    Transition: When student scans fingerprint OR time expires                                       ║
║                                                                                                     ║
╚═════════════════════════════════════════════════════════════════════════════════════════════════════╝


╔═════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                              STATE 3: SCAN SUCCESS SCREEN                                           ║
╠═════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                     ║
║    ┌────────────────────────────────────────────────────┐                                          ║
║    │                                                    │                                          ║
║    │           ┌──────────────┐                         │                                          ║
║    │           │   ✓ ✓ ✓      │                         │                                          ║
║    │           │   PRESENT    │                         │                                          ║
║    │           │   Roll: 37   │                         │                                          ║
║    │           │   Name: XXX  │                         │                                          ║
║    │           │   Score: 98% │                         │                                          ║
║    │           └──────────────┘                         │                                          ║
║    │                                                    │                                          ║
║    │     Time: 09:23:45                                │                                          ║
║    │                                                    │                                          ║
║    └────────────────────────────────────────────────────┘                                          ║
║                                                                                                     ║
║    Display Duration: 2-3 seconds, then return to "Scan your finger" state                          ║
║                                                                                                     ║
╚═════════════════════════════════════════════════════════════════════════════════════════════════════╝


╔═════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                              STATE 4: SCAN FAILURE SCREEN                                           ║
╠═════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                     ║
║    FAILURE TYPE 1: FINGERPRINT NOT RECOGNIZED                                                     ║
║    ───────────────────────────────────────────────                                                 ║
║    ┌────────────────────────────────────────────────────┐                                          ║
║    │                   ✗ ✗ ✗                            │                                          ║
║    │             Fingerprint not found                 │                                          ║
║    │                                                    │                                          ║
║    │             Try again or contact                 │                                          ║
║    │             teacher                               │                                          ║
║    │                                                    │                                          ║
║    └────────────────────────────────────────────────────┘                                          ║
║                                                                                                     ║
║    FAILURE TYPE 2: NOT IN ALLOWED LIST (WRONG BATCH/CLASS)                                         ║
║    ───────────────────────────────────────────────────────────                                      ║
║    ┌────────────────────────────────────────────────────┐                                          ║
║    │                   ✗ ✗ ✗                            │                                          ║
║    │          Not Allowed - Wrong Class/Batch          │                                          ║
║    │          Roll: 75 | Expected: Batch A             │                                          ║
║    │                                                    │                                          ║
║    │          Contact your faculty advisor            │                                          ║
║    │                                                    │                                          ║
║    └────────────────────────────────────────────────────┘                                          ║
║                                                                                                     ║
║    FAILURE TYPE 3: ALREADY MARKED                                                                  ║
║    ────────────────────────────────                                                                ║
║    ┌────────────────────────────────────────────────────┐                                          ║
║    │                   ⚠ ⚠ ⚠                            │                                          ║
║    │           Roll 37 Already Marked                  │                                          ║
║    │                                                    │                                          ║
║    │          You have already marked                 │                                          ║
║    │          attendance for this lecture              │                                          ║
║    │                                                    │                                          ║
║    │          Time: 09:15:30                           │                                          ║
║    │                                                    │                                          ║
║    └────────────────────────────────────────────────────┘                                          ║
║                                                                                                     ║
║    Display Duration: 3-4 seconds, then return to "Scan your finger" state                          ║
║                                                                                                     ║
╚═════════════════════════════════════════════════════════════════════════════════════════════════════╝


╔═════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                            STATE 5: OFFLINE MODE SCREEN                                             ║
╠═════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                     ║
║    ┌────────────────────────────────────────────────────┐                                          ║
║    │ [Session Active - OFFLINE MODE]                   │                                          ║
║    │ Subject: Data Structures                          │                                          ║
║    │ Class: SEM-4-A                                    │                                          ║
║    │ Time Left: 42 min 15 sec                          │                                          ║
║    │ Scanned: 25/60 (5 pending)                        │                                          ║
║    │                                                    │                                          ║
║    │ WiFi: ✗ OFFLINE (⟳ reconnecting...)               │                                          ║
║    │ ► Scan your finger ◄                             │                                          ║
║    │                                                    │                                          ║
║    │ [Scan saved offline] [Battery: 78%]               │                                          ║
║    └────────────────────────────────────────────────────┘                                          ║
║                                                                                                     ║
║    Updates Every: 1 second                                                                         ║
║    Auto-attempts to reconnect every 30 seconds                                                     ║
║                                                                                                     ║
╚═════════════════════════════════════════════════════════════════════════════════════════════════════╝


╔═════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                             STATE 6: SYNCING/UPLOADING SCREEN                                       ║
╠═════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                     ║
║    ┌────────────────────────────────────────────────────┐                                          ║
║    │                                                    │                                          ║
║    │           Syncing Offline Records...              │                                          ║
║    │                                                    │                                          ║
║    │    ███████░░░░░░░░░░░░░░░░░░░░░░░ 35%            │                                          ║
║    │                                                    │                                          ║
║    │    Uploaded: 7/20 records                         │                                          ║
║    │                                                    │                                          ║
║    │    Status: Connecting to server...                │                                          ║
║    │                                                    │                                          ║
║    └────────────────────────────────────────────────────┘                                          ║
║                                                                                                     ║
║    Updated Every: 500ms                                                                            ║
║    Modal Dialog - blocks other input during sync                                                   ║
║                                                                                                     ║
╚═════════════════════════════════════════════════════════════════════════════════════════════════════╝


╔═════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                            STATE 7: SESSION END SCREEN                                              ║
╠═════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                     ║
║    ┌────────────────────────────────────────────────────┐                                          ║
║    │                                                    │                                          ║
║    │           Session Ended                          │                                          ║
║    │                                                    │                                          ║
║    │    Final Statistics:                             │                                          ║
║    │    • Total Students: 60                          │                                          ║
║    │    • Present: 58                                 │                                          ║
║    │    • Absent: 2                                   │                                          ║
║    │    • Records Synced: 58                          │                                          ║
║    │                                                    │                                          ║
║    │    Duration: 9:00 - 9:50 (50 min)               │                                          ║
║    │                                                    │                                          ║
║    │    [Returning to Idle...]                        │                                          ║
║    │                                                    │                                          ║
║    └────────────────────────────────────────────────────┘                                          ║
║                                                                                                     ║
║    Display Duration: 5-10 seconds, then return to IDLE                                             ║
║                                                                                                     ║
╚═════════════════════════════════════════════════════════════════════════════════════════════════════╝


╔═════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                            STATE 8: ERROR/ALERT SCREEN                                              ║
╠═════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                     ║
║    ERROR TYPE 1: INVALID SESSION TOKEN                                                             ║
║    ──────────────────────────────────                                                              ║
║    ┌────────────────────────────────────────────────────┐                                          ║
║    │              ⚠ SECURITY ALERT ⚠                  │                                          ║
║    │                                                    │                                          ║
║    │   Invalid/Expired Session Token                  │                                          ║
║    │   Action: Session Terminated                     │                                          ║
║    │                                                    │                                          ║
║    │   Contact: Faculty/IT Support                    │                                          ║
║    │                                                    │                                          ║
║    └────────────────────────────────────────────────────┘                                          ║
║                                                                                                     ║
║    ERROR TYPE 2: SENSOR MALFUNCTION                                                                ║
║    ────────────────────────────────                                                                ║
║    ┌────────────────────────────────────────────────────┐                                          ║
║    │              ⚠ HARDWARE ERROR ⚠                  │                                          ║
║    │                                                    │                                          ║
║    │   Fingerprint Sensor Not Responding              │                                          ║
║    │   Status: Attempting Recovery...                 │                                          ║
║    │                                                    │                                          ║
║    │   Retries: 5/10                                  │                                          ║
║    │                                                    │                                          ║
║    └────────────────────────────────────────────────────┘                                          ║
║                                                                                                     ║
╚═════════════════════════════════════════════════════════════════════════════════════════════════════╝
```

---

## Display State Transition Diagram

```
                          START
                            │
                            ▼
                    ┌───────────────┐
                    │     BOOT      │
                    │ (Loading...)  │
                    └───────┬───────┘
                            │
                            ▼
                    ┌───────────────┐
                    │  IDLE STATE   │◄─────────┐
                    │ (Waiting...)  │          │
                    └───────┬───────┘          │
                            │                  │
                     [Session Start Received]  │
                            │                  │
                            ▼                  │
                    ┌───────────────┐          │
                    │  ACTIVE       │          │
                    │  (Scanning)   │          │
                    └───────┬───────┘          │
                            │                  │
           ┌────────────────┼────────────────┐ │
           │                │                │ │
    [Scan OK]      [Scan Invalid]    [Time Expired] │
           │                │                │ │
           ▼                ▼                ▼ │
    ┌──────────┐    ┌───────────┐    ┌──────────┐ │
    │  SUCCESS │    │ REJECTION │    │  ENDING  │ │
    │ (2-3 sec)│    │ (3-4 sec) │    │(Syncing) │ │
    └────┬─────┘    └─────┬─────┘    └────┬─────┘ │
         │                │               │      │
         └────────────────┴───────────────┘      │
                          │                      │
                          ▼                      │
                    ┌───────────────┐            │
                    │ SESSION DONE  │            │
                    │  (Summary)    │            │
                    └───────┬───────┘            │
                            │                    │
                            └────────────────────┘
```

---

## Hardware Pinout & Connections

```
┌─────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                      ESP32 PINOUT CONFIGURATION                                     │
├─────────────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                                      │
│   R307 FINGERPRINT SENSOR CONNECTION (UART/TTL)                                                    │
│   ──────────────────────────────────────────────                                                    │
│   R307 TX  ────────────────────────────► ESP32 GPIO 16 (RX2)                                      │
│   R307 RX  ◄────────────────────────────  ESP32 GPIO 17 (TX2)                                      │
│   R307 GND ────────────────────────────► GND (Common)                                              │
│   R307 VCC ────────────────────────────► 5V (via voltage regulator to 3.3V)                       │
│                                                                                                      │
│                                                                                                      │
│   OLED DISPLAY CONNECTION (SPI)                                                                    │
│   ──────────────────────────────────────                                                           │
│   OLED CLK  ────────────────────────────► ESP32 GPIO 14 (SPI CLK)                                 │
│   OLED DIN  ────────────────────────────► ESP32 GPIO 13 (SPI MOSI)                                │
│   OLED DC   ────────────────────────────► ESP32 GPIO 27 (Data/Command)                             │
│   OLED CS   ────────────────────────────► ESP32 GPIO 26 (Chip Select)                              │
│   OLED RST  ────────────────────────────► ESP32 GPIO 25 (Reset)                                   │
│   OLED GND  ────────────────────────────► GND (Common)                                              │
│   OLED VCC  ────────────────────────────► 3.3V                                                    │
│                                                                                                      │
│                                                                                                      │
│   POWER & CONNECTIVITY                                                                              │
│   ────────────────────────                                                                         │
│   USB Power    ────────────────────────► ESP32 USB-C Port (5V input)                               │
│   WiFi         ────────────────────────► Built-in ESP32 Wi-Fi Module                               │
│   LED Indicator────────────────────────► GPIO 2 (Status LED)                                      │
│                                                                                                      │
│                                                                                                      │
│   AVAILABLE GPIO PINS FOR FUTURE USE                                                                │
│   ──────────────────────────────────────                                                           │
│   GPIO 4, 5, 18, 19, 21, 22, 23, 32, 33, 34, 35, 36, 39                                          │
│                                                                                                      │
└─────────────────────────────────────────────────────────────────────────────────────────────────────┘
```
